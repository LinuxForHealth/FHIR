<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.11) on Wed May 19 21:48:58 UTC 2021 -->
<title>ResourceReferenceDAO (IBM FHIR Server)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-05-19">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../../../jquery/jquery-3.5.1.js"></script>
<script type="text/javascript" src="../../../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ResourceReferenceDAO (IBM FHIR Server)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":6,"i3":6,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../../../";
var useModuleDirectories = false;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ResourceReferenceDAO.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
</ul>
<div class="aboutLanguage"><a href="/FHIR" class="bx--header__name" target="_parent"><span>IBM</span>&nbsp;FHIR®&nbsp;Server</a></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../index.html?com/ibm/fhir/persistence/jdbc/dao/impl/ResourceReferenceDAO.html" target="_top">Frames</a></li>
<li><a href="ResourceReferenceDAO.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.ibm.fhir.persistence.jdbc.dao.impl</a></div>
<h2 title="Class ResourceReferenceDAO" class="title">Class ResourceReferenceDAO</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.ibm.fhir.persistence.jdbc.dao.impl.ResourceReferenceDAO</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../api/IResourceReferenceDAO.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">IResourceReferenceDAO</a></code>, <code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></code></dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="../../db2/Db2ResourceReferenceDAO.html" title="class in com.ibm.fhir.persistence.jdbc.db2">Db2ResourceReferenceDAO</a></code>, <code><a href="../../derby/DerbyResourceReferenceDAO.html" title="class in com.ibm.fhir.persistence.jdbc.derby">DerbyResourceReferenceDAO</a></code>, <code><a href="../../postgres/PostgresResourceReferenceDAO.html" title="class in com.ibm.fhir.persistence.jdbc.postgres">PostgresResourceReferenceDAO</a></code></dd>
</dl>
<hr>
<pre>public abstract class <span class="typeNameLabel">ResourceReferenceDAO</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>
implements <a href="../api/IResourceReferenceDAO.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">IResourceReferenceDAO</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></pre>
<div class="block">DAO to handle maintenance of the local and external reference tables
 which contain the relationships described by "reference" elements in
 each resource (e.g. Observation.subject).

 The DAO uses a cache for looking up the ids for various entities. The
 DAO can create new entries, but these can only be used locally until
 the transaction commits, at which point they can be consolidated into
 the shared cache. This has the benefit that we reduce the number of times
 we need to lock the global cache, because we only update it once per
 transaction.

 For improved performance, we also make use of batch statements which
 are managed as member variables. This is why it's important to close
 this DAO before the transaction commits, ensuring that any outstanding
 DML batched but not yet executed is processed. Calling close does not
 close the provided Connection. That is up to the caller to manage.
 Close does close any statements which are opened inside the class.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#BATCH_SIZE">BATCH_SIZE</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(com.ibm.fhir.database.utils.api.IDatabaseTranslator,java.sql.Connection,java.lang.String,com.ibm.fhir.persistence.jdbc.dao.api.ICommonTokenValuesCache)">ResourceReferenceDAO</a></span>&#8203;(<a href="../../../../database/utils/api/IDatabaseTranslator.html" title="interface in com.ibm.fhir.database.utils.api">IDatabaseTranslator</a>&nbsp;t,
                    <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html?is-external=true" title="class or interface in java.sql" class="externalLink">Connection</a>&nbsp;c,
                    <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;schemaName,
                    <a href="../api/ICommonTokenValuesCache.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">ICommonTokenValuesCache</a>&nbsp;cache)</code></th>
<td class="colLast">
<div class="block">Public constructor</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addCommonTokenValues(java.lang.String,java.util.Collection)">addCommonTokenValues</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;resourceType,
                    <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;xrefs)</code></th>
<td class="colLast">
<div class="block">Add TOKEN_VALUE_MAP records, creating any CODE_SYSTEMS and COMMON_TOKEN_VALUES
 as necessary</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#close()">close</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#doCodeSystemsUpsert(java.lang.String,java.util.Collection)">doCodeSystemsUpsert</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;paramList,
                   <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;systemNames)</code></th>
<td class="colLast">
<div class="block">Insert any missing values into the code_systems table</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#doCommonTokenValuesUpsert(java.lang.String,java.util.Collection)">doCommonTokenValuesUpsert</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;paramList,
                         <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="../../dto/CommonTokenValue.html" title="class in com.ibm.fhir.persistence.jdbc.dto">CommonTokenValue</a>&gt;&nbsp;tokenValues)</code></th>
<td class="colLast">
<div class="block">Execute the insert (upsert) into the common_token_values table for the
 given collection of values.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flush()">flush</a></span>()</code></th>
<td class="colLast">
<div class="block">Execute any statements with pending batch entries</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected <a href="../api/ICommonTokenValuesCache.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">ICommonTokenValuesCache</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCache()">getCache</a></span>()</code></th>
<td class="colLast">
<div class="block">Getter for the <a href="../api/ICommonTokenValuesCache.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api"><code>ICommonTokenValuesCache</code></a> held by this DAO</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>protected <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html?is-external=true" title="class or interface in java.sql" class="externalLink">Connection</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getConnection()">getConnection</a></span>()</code></th>
<td class="colLast">
<div class="block">Getter for the <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html?is-external=true" title="class or interface in java.sql" class="externalLink"><code>Connection</code></a> held by this DAO</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="../api/ICommonTokenValuesCache.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">ICommonTokenValuesCache</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getResourceReferenceCache()">getResourceReferenceCache</a></span>()</code></th>
<td class="colLast">
<div class="block">Get the cache used by the DAO</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>protected <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSchemaName()">getSchemaName</a></span>()</code></th>
<td class="colLast">
<div class="block">Getter for subclass access to the schemaName</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../database/utils/api/IDatabaseTranslator.html" title="interface in com.ibm.fhir.database.utils.api">IDatabaseTranslator</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTranslator()">getTranslator</a></span>()</code></th>
<td class="colLast">
<div class="block">Getter for the <a href="../../../../database/utils/api/IDatabaseTranslator.html" title="interface in com.ibm.fhir.database.utils.api"><code>IDatabaseTranslator</code></a> held by this DAO</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#insertResourceTokenRefs(java.lang.String,java.util.Collection)">insertResourceTokenRefs</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;resourceType,
                       <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;xrefs)</code></th>
<td class="colLast">
<div class="block">Insert the values in the resource-type-specific _resource_token_refs table.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#persist(java.util.Collection)">persist</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;records)</code></th>
<td class="colLast">
<div class="block">Persist the records, which may span multiple resource types</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="../../dto/CommonTokenValueResult.html" title="class in com.ibm.fhir.persistence.jdbc.dto">CommonTokenValueResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#readCommonTokenValueId(java.lang.String,java.lang.String)">readCommonTokenValueId</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;codeSystem,
                      <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tokenValue)</code></th>
<td class="colLast">
<div class="block">Find the database id for the given token value and system</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#readCommonTokenValueIdList(java.lang.String)">readCommonTokenValueIdList</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tokenValue)</code></th>
<td class="colLast">
<div class="block">Fetch the list of matching common_token_value_id records for the given tokenValue.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#upsertCodeSystems(java.util.List)">upsertCodeSystems</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;systems)</code></th>
<td class="colLast">
<div class="block">Add all the systems we currently don't have in the database.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#upsertCommonTokenValues(java.util.List)">upsertCommonTokenValues</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;values)</code></th>
<td class="colLast">
<div class="block">Add reference value records for each unique reference name in the given list</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="BATCH_SIZE">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BATCH_SIZE</h4>
<pre>protected static final&nbsp;int BATCH_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../../constant-values.html#com.ibm.fhir.persistence.jdbc.dao.impl.ResourceReferenceDAO.BATCH_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(com.ibm.fhir.database.utils.api.IDatabaseTranslator,java.sql.Connection,java.lang.String,com.ibm.fhir.persistence.jdbc.dao.api.ICommonTokenValuesCache)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ResourceReferenceDAO</h4>
<pre>public&nbsp;ResourceReferenceDAO&#8203;(<a href="../../../../database/utils/api/IDatabaseTranslator.html" title="interface in com.ibm.fhir.database.utils.api">IDatabaseTranslator</a>&nbsp;t,
                            <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html?is-external=true" title="class or interface in java.sql" class="externalLink">Connection</a>&nbsp;c,
                            <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;schemaName,
                            <a href="../api/ICommonTokenValuesCache.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">ICommonTokenValuesCache</a>&nbsp;cache)</pre>
<div class="block">Public constructor</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>c</code> - </dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="getTranslator()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTranslator</h4>
<pre class="methodSignature">protected&nbsp;<a href="../../../../database/utils/api/IDatabaseTranslator.html" title="interface in com.ibm.fhir.database.utils.api">IDatabaseTranslator</a>&nbsp;getTranslator()</pre>
<div class="block">Getter for the <a href="../../../../database/utils/api/IDatabaseTranslator.html" title="interface in com.ibm.fhir.database.utils.api"><code>IDatabaseTranslator</code></a> held by this DAO</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a id="getCache()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCache</h4>
<pre class="methodSignature">protected&nbsp;<a href="../api/ICommonTokenValuesCache.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">ICommonTokenValuesCache</a>&nbsp;getCache()</pre>
<div class="block">Getter for the <a href="../api/ICommonTokenValuesCache.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api"><code>ICommonTokenValuesCache</code></a> held by this DAO</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a id="getConnection()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConnection</h4>
<pre class="methodSignature">protected&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html?is-external=true" title="class or interface in java.sql" class="externalLink">Connection</a>&nbsp;getConnection()</pre>
<div class="block">Getter for the <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html?is-external=true" title="class or interface in java.sql" class="externalLink"><code>Connection</code></a> held by this DAO</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a id="getSchemaName()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSchemaName</h4>
<pre class="methodSignature">protected&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;getSchemaName()</pre>
<div class="block">Getter for subclass access to the schemaName</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a id="flush()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flush</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;flush()
           throws <a href="../../../exception/FHIRPersistenceException.html" title="class in com.ibm.fhir.persistence.exception">FHIRPersistenceException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../api/IResourceReferenceDAO.html#flush()">IResourceReferenceDAO</a></code></span></div>
<div class="block">Execute any statements with pending batch entries</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../api/IResourceReferenceDAO.html#flush()">flush</a></code>&nbsp;in interface&nbsp;<code><a href="../api/IResourceReferenceDAO.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">IResourceReferenceDAO</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../exception/FHIRPersistenceException.html" title="class in com.ibm.fhir.persistence.exception">FHIRPersistenceException</a></code></dd>
</dl>
</li>
</ul>
<a id="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;close()
           throws <a href="../../../exception/FHIRPersistenceException.html" title="class in com.ibm.fhir.persistence.exception">FHIRPersistenceException</a></pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true#close()" title="class or interface in java.lang" class="externalLink">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../exception/FHIRPersistenceException.html" title="class in com.ibm.fhir.persistence.exception">FHIRPersistenceException</a></code></dd>
</dl>
</li>
</ul>
<a id="getResourceReferenceCache()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getResourceReferenceCache</h4>
<pre class="methodSignature">public&nbsp;<a href="../api/ICommonTokenValuesCache.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">ICommonTokenValuesCache</a>&nbsp;getResourceReferenceCache()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../api/IResourceReferenceDAO.html#getResourceReferenceCache()">IResourceReferenceDAO</a></code></span></div>
<div class="block">Get the cache used by the DAO</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../api/IResourceReferenceDAO.html#getResourceReferenceCache()">getResourceReferenceCache</a></code>&nbsp;in interface&nbsp;<code><a href="../api/IResourceReferenceDAO.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">IResourceReferenceDAO</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a id="readCommonTokenValueId(java.lang.String,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readCommonTokenValueId</h4>
<pre class="methodSignature">public&nbsp;<a href="../../dto/CommonTokenValueResult.html" title="class in com.ibm.fhir.persistence.jdbc.dto">CommonTokenValueResult</a>&nbsp;readCommonTokenValueId&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;codeSystem,
                                                     <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tokenValue)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../api/IResourceReferenceDAO.html#readCommonTokenValueId(java.lang.String,java.lang.String)">IResourceReferenceDAO</a></code></span></div>
<div class="block">Find the database id for the given token value and system</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../api/IResourceReferenceDAO.html#readCommonTokenValueId(java.lang.String,java.lang.String)">readCommonTokenValueId</a></code>&nbsp;in interface&nbsp;<code><a href="../api/IResourceReferenceDAO.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">IResourceReferenceDAO</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the matching id from common_token_values.common_token_value_id or null if not found</dd>
</dl>
</li>
</ul>
<a id="addCommonTokenValues(java.lang.String,java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addCommonTokenValues</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;addCommonTokenValues&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;resourceType,
                                 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;xrefs)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../api/IResourceReferenceDAO.html#addCommonTokenValues(java.lang.String,java.util.Collection)">IResourceReferenceDAO</a></code></span></div>
<div class="block">Add TOKEN_VALUE_MAP records, creating any CODE_SYSTEMS and COMMON_TOKEN_VALUES
 as necessary</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../api/IResourceReferenceDAO.html#addCommonTokenValues(java.lang.String,java.util.Collection)">addCommonTokenValues</a></code>&nbsp;in interface&nbsp;<code><a href="../api/IResourceReferenceDAO.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">IResourceReferenceDAO</a></code></dd>
</dl>
</li>
</ul>
<a id="insertResourceTokenRefs(java.lang.String,java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>insertResourceTokenRefs</h4>
<pre class="methodSignature">protected&nbsp;void&nbsp;insertResourceTokenRefs&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;resourceType,
                                       <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;xrefs)</pre>
<div class="block">Insert the values in the resource-type-specific _resource_token_refs table. This
 is a simple batch insert because all the FKs have already been resolved and updated
 in the ResourceTokenValueRec records</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>resourceType</code> - </dd>
<dd><code>xrefs</code> - </dd>
</dl>
</li>
</ul>
<a id="upsertCodeSystems(java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>upsertCodeSystems</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;upsertCodeSystems&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;systems)</pre>
<div class="block">Add all the systems we currently don't have in the database. If all target
 databases handled MERGE properly this would be easy, but they don't so
 we go old-school with a negative outer join instead (which is pretty much
 what MERGE does behind the scenes anyway).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>systems</code> - </dd>
</dl>
</li>
</ul>
<a id="doCodeSystemsUpsert(java.lang.String,java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doCodeSystemsUpsert</h4>
<pre class="methodSignature">public abstract&nbsp;void&nbsp;doCodeSystemsUpsert&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;paramList,
                                         <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;systemNames)</pre>
<div class="block">Insert any missing values into the code_systems table</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>paramList</code> - </dd>
<dd><code>systems</code> - </dd>
</dl>
</li>
</ul>
<a id="upsertCommonTokenValues(java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>upsertCommonTokenValues</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;upsertCommonTokenValues&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;values)</pre>
<div class="block">Add reference value records for each unique reference name in the given list</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>values</code> - </dd>
</dl>
</li>
</ul>
<a id="doCommonTokenValuesUpsert(java.lang.String,java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doCommonTokenValuesUpsert</h4>
<pre class="methodSignature">protected abstract&nbsp;void&nbsp;doCommonTokenValuesUpsert&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;paramList,
                                                  <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="../../dto/CommonTokenValue.html" title="class in com.ibm.fhir.persistence.jdbc.dto">CommonTokenValue</a>&gt;&nbsp;tokenValues)</pre>
<div class="block">Execute the insert (upsert) into the common_token_values table for the
 given collection of values. Note, this insert from negative outer join
 requires the database concurrency implementation to be correct. This does
 not work for Postgres, hence Postgres gets its own implementation of this
 method</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>paramList</code> - </dd>
<dd><code>tokenValues</code> - </dd>
</dl>
</li>
</ul>
<a id="persist(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>persist</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;persist&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="ResourceTokenValueRec.html" title="class in com.ibm.fhir.persistence.jdbc.dao.impl">ResourceTokenValueRec</a>&gt;&nbsp;records)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../api/IResourceReferenceDAO.html#persist(java.util.Collection)">IResourceReferenceDAO</a></code></span></div>
<div class="block">Persist the records, which may span multiple resource types</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../api/IResourceReferenceDAO.html#persist(java.util.Collection)">persist</a></code>&nbsp;in interface&nbsp;<code><a href="../api/IResourceReferenceDAO.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">IResourceReferenceDAO</a></code></dd>
</dl>
</li>
</ul>
<a id="readCommonTokenValueIdList(java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>readCommonTokenValueIdList</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&gt;&nbsp;readCommonTokenValueIdList&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tokenValue)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../api/IResourceReferenceDAO.html#readCommonTokenValueIdList(java.lang.String)">IResourceReferenceDAO</a></code></span></div>
<div class="block">Fetch the list of matching common_token_value_id records for the given tokenValue.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../api/IResourceReferenceDAO.html#readCommonTokenValueIdList(java.lang.String)">readCommonTokenValueIdList</a></code>&nbsp;in interface&nbsp;<code><a href="../api/IResourceReferenceDAO.html" title="interface in com.ibm.fhir.persistence.jdbc.dao.api">IResourceReferenceDAO</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ResourceReferenceDAO.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
</ul>
<div class="aboutLanguage"><a href="/FHIR" class="bx--header__name" target="_parent"><span>IBM</span>&nbsp;FHIR®&nbsp;Server</a></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../index.html?com/ibm/fhir/persistence/jdbc/dao/impl/ResourceReferenceDAO.html" target="_top">Frames</a></li>
<li><a href="ResourceReferenceDAO.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright 2019, 2021. <a href="http://www.ibm.com">IBM Corporation<a><br></br>FHIR&reg; is the registered trademark of HL7 and is used with the permission of HL7.</small></p>
</footer>
</body>
</html>
